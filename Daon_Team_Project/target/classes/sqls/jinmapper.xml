<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.min.edu.model.JinDaon_DaoImpl.jingu">

<!-- 현재 과정 조회 -->
<select id="iselCourse" parameterType="java.util.Map" resultType="courseDto">
SELECT COU_CODE, COU_CNT, COU_NAME, STARTDATE, TOTALTIME, TEA_ID, ENDDATE, STATE 
		FROM(SELECT COU_CODE, COU_CNT, COU_NAME, COU_EXP, 
				STARTDATE, TOTALTIME, TEA_ID, ENDDATE, STATE,ROWNUM RN FROM D_COURSE)
			WHERE RN BETWEEN #{startList} AND #{endList} AND STATE ='I'
</select>
<!-- 과정 상세 조회 -->
<select id="detailCourse" parameterType="java.lang.String" resultType="courseDto">
SELECT COU_CODE, COU_CNT, COU_NAME, COU_EXP, STARTDATE, 
	TOTALTIME, TEA_ID, ENDDATE, STATE 
		FROM D_COURSE 
			WHERE COU_CODE =#{cou_code}
</select>

<!-- 학생의 현재 과정 조회 -->
<select id="stuiselCourse" parameterType="java.lang.String" resultType="stucouselDto">
SELECT SCSEQ, STU_ID, TEA_ID, COU_NAME, COU_EXP, STARTDATE, TOTALTIME, ENDDATE, COU_CNT, STATE
	FROM D_STUCOU JOIN D_COURSE USING(COU_CODE)
		WHERE STATE ='I' AND STU_ID =#{stu_id}
</select>
<!-- 과목 조회 -->
<select id="selSubject" parameterType="java.util.Map" resultType="subjectDto">
SELECT SUB_CODE, SUB_NAME, SUB_TIME
	FROM (SELECT SUB_CODE, SUB_NAME, SUB_EXP, SUB_TIME, ROWNUM RN FROM D_SUBJECT)
		WHERE RN BETWEEN #{startList} AND #{endList}
</select>
<!-- 과목 상세조회 -->
<select id="detailSubject" parameterType="java.lang.String" resultType="subjectDto">
SELECT SUB_CODE, SUB_NAME, SUB_EXP, SUB_TIME
	FROM D_SUBJECT
		WHERE SUB_CODE=#{sub_code}
</select>
<!-- 학생의 커리큘럼 조회 ???-->
<select id="stuselCurriculu" parameterType="java.util.Map" resultType="stuavgselDto">
SELECT SUB_CODE, SUB_NAME, SUB_TIME, SUM(JUMSU) JUMSU, CUR_CODE
	FROM D_STUCOU
		JOIN D_COURSE USING(COU_CODE) 
			JOIN D_CURRICULUM USING(COU_CODE) 
				JOIN D_SUBJECT USING(SUB_CODE)
					JOIN D_ANSWERSCORE USING(STU_ID)
	WHERE STU_ID=#{stu_id} AND COU_CODE=#{cou_code} 
		GROUP BY STU_ID, SUB_CODE, SUB_NAME, SUB_TIME, CUR_CODE
</select>


</mapper>
